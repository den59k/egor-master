О чем рассказать:

# Слайд 1
Добрый день, меня зовут Денис Хохряков, и сегодня я хочу показать вам проект по разработке модуля
передачи потоковых данных по технологии WebRTC, в последствии называемом "Медиасервер"

# Слайд 2

И самый первый вопрос, наверное, чем я вообще занимался? 
Суть моей работы заключается в разработке некоего микросервисного приложения, 
которое будет работать в связке с бэкендом платформы GreenData. 
Приложение позволит осуществлять звонки (как видео, так и аудио), используя всю мощь серверов GreenData.

Создание VoIP телефонии - довольно внушительный процесс, а поэтому, как и любое большое дело, его стоит разбить на задачи:
* Сначала определимся, зачем вообще этим заниматься, если на рынке полно разного рода систем для видеосвязи
* Окей, после этого надо вникнуть в саму систему WebRTC и оценить текущую ситуацию на рынке систем с этой технологией
* Затем можно представить архитектуру для будущей системы, ориентируясь на задачи, которые она будет выполнять
* Ну и разработать саму систему,
* После чего описать все API для того, чтобы старшие разработчики гриндаты могли интегрировать сервис к себе на бэкенд.

# Слайд 3

Для начала пара слов о существующей платформе GreenData. GreenData - это продукт одноименной компании, предназначенная
для создания крупных бизнес-приложений для крупных компаний, в основном финансовых, к примеру, банков.

Также вместе с платформой поставляется приложение GreenBox, доступное как на IOS, так и на Android. 
Данное приложение позволяет использовать функции платформы прямо с мобильных устройств.

Основной частью приложения является мессенджер, в котором есть возможность создавать различные чаты
прямо вокруг объектов системы. 
Поскольку общение через видео является более эффективным, чем обычные текстовые сообщения,
в данном приложении реализована возможность проводить видеозвонки.

# Слайд 4

На данный момент видеосвязь реализована через сервис Agora, который представляет SDK для работы
на разных устройствах. Из плюсов агоры выделяются ее надежность и простота интеграции,
однако, большинство клиентов GreenData - государственные организации, а потому
им требуется повышенный уровень конфиденциальности, а Agora - частное ПО, выполняющееся
серверах агоры, а поэтому, к ним меньше доверия.

Также в агоре стоит поминутная тарификация, что приносит большие затраты при общении
большого количества пользователей.

Разработка собственного медиасервера позоволит решить данные проблемы.

# Слайд 5

Окей, мы определились с тем, что сервер нам нужен, а потому давайте определимся с технологиями.
Я сегодня уже несколько раз сказал WebRTC, но не рассказал, что это такое. 
На самом деле WebRTC - это шикарный проект, разрабатываемый еще с 2011 года, и предназначенный для того, чтобы устанавливать видео-соединение стандартными средствами браузера.
Он уже давно стандартизирован, а потому реализован во всех современных браузерах, а также существует в виде подключаемой библиотеки к приложениям
на java для Android, и на Swift на IOS

Сам WebRTC представляет собой лишь клиентскую часть в браузере, которая реализует сразу пачку протоколов

# Слайд 6

Итак, как было сказано ранее, WebRTC использует принцип p2p, а потому он способен соединить только два устройства между собой.
Для организации конференции же, необходимо выстраивать дополнительные схемы подключения.

Одной из очевидных схем является схема Mesh, где мы подключаем каждого участника с каждым. В этом случае не требуется 
дополнительного оборудования (кроме сигнального сервера), однако это приводит к высоким нагрузкам как на сеть, так и 
на устройства пользователей, поскольку каждый поток приходится кодировать и шифровать отдельно.

Поэтому необходимо дополнительное оборудование, позволяющее обрабатывать входящие потоки и распределять их между участниками конференции.
При этом он может работать по принципу SFU, то есть только лишь раздавать медиапотоки между пользователями не перекодируя их.

# Слайд 7

Существует несколько систем для обеспечения таких конференций, например Jitsi или Kurento. Однако из всех была выбрана
библиотека Mediasoup, поскольку она является опенсорсной и при этом её основной код выполняется на машинном уровне,
что позволяет достичь высокого быстродействия, даже при большом количестве участников.

Однако, клиентские библиотеки mediasoup доступны только для браузеров, а поэтому есть необходимость
в написании собственного ПО, которое будет преобразовывать информацию из MediaSoup в нативный SDP для WebRTC.

# Слайд 8

Итак, чтобы разработать микросервис, нужно выделить задачи, которые он должен решать:
* создавать комнаты, в которых будет происходить общение участников;
* создавать транспорт, через который будет происходить обмен потоковыми данными;
* выводить информацию об входящих подключениях, чтобы передавать её новым участникам
* при этом он должен преобразовывать информацию из MediaSoup в SDP и обратно;
* предоставлять API для внешнего бэкенд-приложения;

# Слайд 9
И, теперь я наконец могу предоставить вашему вниманию архитектуру медиасервера. 
Он использует объекты MediaSoup, и соединяет их с объектами WebRTC, обеспечивая видеосвязь.

Окей, вы сейчас думаете: здесь WebRTC, здесь MediaSoup, а где мой вклад? 
А вот в том, что создал класс User, который включал в себя методы работы с транспортом, продьюсерами и консумерами.
Также я создал класс Room, который занимался тем, что создавал объекты Router, добавляя к ним пользователей,
а также класс приложения, который занимался созданием этих самых комнат.

# Слайд 10
Чтобы запустить приложение есть два пути: 
Либо установить все зависимости в систему, и запустить данный проект. Либо же воспользоваться инструментом Docker, который
позволяет запустить систему в отдельном контейнере.

# Слайд 11

Медиасервер не обменивается сигнальными данными с клиентом напрямую. Это происходит через бэкенд гриндаты, общение
которых защищено протоколом HTTPS

# Слайд 12
Итак, в ходе работы были выполнены следующие задачи:
